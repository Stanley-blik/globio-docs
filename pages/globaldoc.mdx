# GlobalDoc - Document Database

<div style={{textAlign: 'center', margin: '2rem 0'}}>
  <div style={{fontSize: '1.5rem', marginBottom: '1rem'}}>
    <strong>GlobalDoc</strong> is Globio's Firebase-compatible document database service
  </div>
  <div style={{fontSize: '1.2rem', color: '#6b7280'}}>
    Store, query, and sync JSON documents with real-time updates - all at 99% less cost than Firestore.
  </div>
</div>

<div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '1.5rem', margin: '2rem 0'}}>
  <div style={{padding: '1.5rem', border: '1px solid #e5e7eb', borderRadius: '0.75rem', backgroundColor: '#f9fafb', textAlign: 'center'}}>
    <div style={{fontSize: '2.5rem', marginBottom: '0.5rem'}}>ğŸ—„ï¸</div>
    <h3 style={{margin: '0.5rem 0'}}>Structured Data</h3>
    <p>Relational database that lives at the edge with ACID transactions</p>
  </div>
  <div style={{padding: '1.5rem', border: '1px solid #e5e7eb', borderRadius: '0.75rem', backgroundColor: '#f9fafb', textAlign: 'center'}}>
    <div style={{fontSize: '2.5rem', marginBottom: '0.5rem'}}>âš¡</div>
    <h3 style={{margin: '0.5rem 0'}}>Real-time Sync</h3>
    <p>Instant updates across all connected clients with sub-50ms latency</p>
  </div>
  <div style={{padding: '1.5rem', border: '1px solid #e5e7eb', borderRadius: '0.75rem', backgroundColor: '#f9fafb', textAlign: 'center'}}>
    <div style={{fontSize: '2.5rem', marginBottom: '0.5rem'}}>ğŸ’°</div>
    <h3 style={{margin: '0.5rem 0'}}>99% Savings</h3>
    <p>Compared to Firebase Firestore with the same performance</p>
  </div>
</div>

## ğŸš€ Quick Start

<div style={{background: '#f8fafc', padding: '1rem', borderRadius: '0.5rem', border: '1px solid #e2e8f0', margin: '1rem 0'}}>
```javascript
import { GlobalDoc } from '@stanlink/globio'

const globio = new GlobalDoc({
  apiKey: 'your-api-key',
  projectId: 'your-project-id'
})

// Add a document
const users = globio.collection('users')
const docRef = await users.add({
  name: 'John Doe',
  email: 'john@example.com',
  level: 5,
  createdAt: new Date()
})

console.log('Document added with ID:', docRef.id)
```
</div>

## ğŸ“š Core Concepts

### Collections
ğŸ“‚ Collections are containers for documents. Think of them as tables in a traditional database.

```javascript
// Get a collection reference
const users = globio.collection('users')
const posts = globio.collection('posts')
const gameStats = globio.collection('gameStats')
```

### Documents
ğŸ“„ Documents are JSON objects stored in collections. Each document has a unique ID.

```javascript
// Add a document with auto-generated ID
const docRef = await users.add({
  name: 'Alice',
  score: 1500,
  achievements: ['first-win', 'level-10']
})

// Add a document with custom ID
await users.doc('player123').set({
  name: 'Bob',
  score: 2000,
  lastLogin: new Date()
})
```

## ğŸ” Querying Data

### Simple Queries

<div style={{background: '#f8fafc', padding: '1rem', borderRadius: '0.5rem', border: '1px solid #e2e8f0', margin: '1rem 0'}}>
```javascript
// Get all documents
const snapshot = await users.get()
snapshot.forEach(doc => {
  console.log(doc.id, doc.data())
})

// Query with conditions
const highScorers = await users
  .where('score', '>=', 1000)
  .get()

// Order and limit results
const topPlayers = await users
  .orderBy('score', 'desc')
  .limit(10)
  .get()
```
</div>

### Complex Queries

<div style={{background: '#f8fafc', padding: '1rem', borderRadius: '0.5rem', border: '1px solid #e2e8f0', margin: '1rem 0'}}>
```javascript
// Multiple conditions
const activeHighScorers = await users
  .where('score', '>=', 1000)
  .where('status', '==', 'active')
  .where('lastLogin', '>=', new Date('2024-01-01'))
  .orderBy('score', 'desc')
  .limit(50)
  .get()

// Array queries
const achievementHunters = await users
  .where('achievements', 'array-contains', 'rare-collector')
  .get()

// In queries
const specificUsers = await users
  .where('userId', 'in', ['user1', 'user2', 'user3'])
  .get()
```
</div>

## ğŸ“ Writing Data

### Adding Documents
â• Add documents with auto-generated or custom IDs

```javascript
// Add with auto-generated ID
const docRef = await users.add({
  name: 'Charlie',
  level: 1
})

// Add with custom ID
await users.doc('charlie123').set({
  name: 'Charlie',
  level: 1
})
```

### Updating Documents
âœï¸ Update specific fields in existing documents

```javascript
// Update specific fields
await users.doc('charlie123').update({
  level: 2,
  lastUpdated: new Date()
})

// Set with merge (updates existing fields, adds new ones)
await users.doc('charlie123').set({
  newField: 'value'
}, { merge: true })
```

### Deleting Documents
ğŸ—‘ï¸ Remove documents or fields

```javascript
// Delete a document
await users.doc('charlie123').delete()

// Delete a field
await users.doc('alice123').update({
  temporaryField: null // This deletes the field
})
```

## âš¡ Real-time Updates

### Listen to Documents
ğŸ‘‚ Subscribe to real-time changes on individual documents

```javascript
// Listen to a single document
const unsubscribe = users.doc('player123').onSnapshot(doc => {
  if (doc.exists) {
    console.log('Player data:', doc.data())
  }
})

// Stop listening
unsubscribe()
```

### Listen to Collections
ğŸ“š Subscribe to real-time changes on collections and queries

```javascript
// Listen to all users
const unsubscribe = users.onSnapshot(snapshot => {
  snapshot.forEach(doc => {
    console.log('User updated:', doc.data())
  })
})

// Listen to query results
const unsubscribe = users
  .where('online', '==', true)
  .onSnapshot(snapshot => {
    console.log('Online users:', snapshot.size)
  })
```

## ğŸ”„ Batch Operations

### Batch Writes
ğŸ“¦ Perform multiple write operations atomically

```javascript
const batch = globio.batch()

// Add multiple operations to batch
batch.set(users.doc('user1'), { name: 'User 1', score: 100 })
batch.update(users.doc('user2'), { score: 200 })
batch.delete(users.doc('user3'))

// Commit all operations atomically
await batch.commit()
```

### Transactions
ğŸ”„ Read and write data atomically

```javascript
await globio.runTransaction(async (transaction) => {
  // Read data
  const userDoc = await transaction.get(users.doc('player123'))
  const currentScore = userDoc.data().score
  
  // Write data based on read
  transaction.update(users.doc('player123'), {
    score: currentScore + 100,
    lastUpdated: new Date()
  })
})
```

## ğŸ® Gaming Examples

### Player Profiles
ğŸ‘¤ Create and manage player data

```javascript
// Create player profile
await users.doc(playerId).set({
  name: playerName,
  level: 1,
  experience: 0,
  coins: 100,
  inventory: [],
  achievements: [],
  stats: {
    gamesPlayed: 0,
    gamesWon: 0,
    totalPlayTime: 0
  },
  createdAt: new Date(),
  lastLogin: new Date()
})

// Level up player
await globio.runTransaction(async (transaction) => {
  const playerDoc = await transaction.get(users.doc(playerId))
  const player = playerDoc.data()
  
  transaction.update(users.doc(playerId), {
    level: player.level + 1,
    experience: 0, // Reset XP for new level
    coins: player.coins + 50 // Level up bonus
  })
})
```

### Leaderboards
ğŸ† Track top players and rankings

```javascript
// Get top 10 players by score
const leaderboard = await users
  .orderBy('score', 'desc')
  .limit(10)
  .get()

// Get player's rank
const playersAbove = await users
  .where('score', '>', playerScore)
  .get()
const playerRank = playersAbove.size + 1
```

### Game Sessions
ğŸ® Track individual game sessions

```javascript
const sessions = globio.collection('gameSessions')

// Start game session
const sessionRef = await sessions.add({
  playerId: playerId,
  gameMode: 'battle-royale',
  startTime: new Date(),
  status: 'active',
  score: 0,
  kills: 0
})

// Update session during game
await sessionRef.update({
  score: currentScore,
  kills: currentKills,
  lastUpdate: new Date()
})

// End session
await sessionRef.update({
  endTime: new Date(),
  status: 'completed',
  duration: endTime - startTime
})
```

## ğŸ”’ Security Rules

### Basic Rules
ğŸ”’ Control access to your data

```javascript
// Only authenticated users can read/write their own data
const userDoc = users.doc(currentUser.uid)
await userDoc.set(userData) // âœ… Allowed
await users.doc('otherUser').set(data) // âŒ Denied
```

### Collection-level Security
ğŸ›¡ï¸ Set permissions for entire collections

```javascript
// Public leaderboards (read-only for all users)
const leaderboard = globio.collection('leaderboard')
const topPlayers = await leaderboard.get() // âœ… Anyone can read

// Private user data
const privateData = globio.collection('privateUserData')
// Only the user can access their own private data
```

## ğŸ“Š Performance Tips

### Indexing
ğŸ” Optimize queries with proper indexes

```javascript
// Compound queries require indexes
// This query needs an index on (status, score)
const activeTopPlayers = await users
  .where('status', '==', 'active')
  .orderBy('score', 'desc')
  .limit(10)
  .get()
```

### Pagination
ğŸ“‹ Efficiently load large datasets

```javascript
// Efficient pagination
let lastDoc = null
const pageSize = 20

async function getNextPage() {
  let query = users
    .orderBy('createdAt')
    .limit(pageSize)
  
  if (lastDoc) {
    query = query.startAfter(lastDoc)
  }
  
  const snapshot = await query.get()
  lastDoc = snapshot.docs[snapshot.docs.length - 1]
  
  return snapshot.docs.map(doc => doc.data())
}
```

### Caching
ğŸ’¾ Cache frequently accessed data

```javascript
// Cache frequently accessed data
const cache = new Map()

async function getCachedUser(userId) {
  if (cache.has(userId)) {
    return cache.get(userId)
  }
  
  const doc = await users.doc(userId).get()
  const userData = doc.data()
  
  cache.set(userId, userData)
  return userData
}
```

## ğŸš€ Migration from Firestore

### Code Changes
ğŸ”„ Simple API migration

```javascript
// Before (Firestore)
import { getFirestore, collection, addDoc } from 'firebase/firestore'
const db = getFirestore()
const usersRef = collection(db, 'users')
await addDoc(usersRef, userData)

// After (GlobalDoc)
import { GlobalDoc } from '@stanlink/globio'
const globio = new GlobalDoc({ apiKey: 'your-key' })
const users = globio.collection('users')
await users.add(userData)
```

### Data Migration
ğŸšš Export and import your data

```javascript
// Export from Firestore and import to GlobalDoc
async function migrateCollection(collectionName) {
  // Export from Firestore
  const firestoreSnapshot = await firestoreDb.collection(collectionName).get()
  
  // Import to GlobalDoc
  const batch = globio.batch()
  firestoreSnapshot.forEach(doc => {
    batch.set(globio.collection(collectionName).doc(doc.id), doc.data())
  })
  
  await batch.commit()
  console.log(`Migrated ${collectionName}`)
}
```

## ğŸ’¡ Best Practices

### Data Structure
ğŸ—ï¸ Design efficient document structures

```javascript
// âœ… Good: Flat structure
{
  userId: 'player123',
  name: 'John',
  level: 5,
  stats_gamesPlayed: 100,
  stats_gamesWon: 75
}

// âŒ Avoid: Deep nesting
{
  userId: 'player123',
  profile: {
    personal: {
      name: 'John',
      details: {
        level: 5
      }
    }
  }
}
```

### Field Names
ğŸ·ï¸ Use consistent naming conventions

```javascript
// âœ… Use consistent naming
{
  createdAt: new Date(),
  updatedAt: new Date(),
  isActive: true,
  playerCount: 4
}

// âŒ Inconsistent naming
{
  created_at: new Date(),
  UpdatedTime: new Date(),
  active: true,
  numPlayers: 4
}
```

## ğŸ”§ Advanced Features

### Subcollections
ğŸ“ Organize related data hierarchically

```javascript
// User's game sessions as subcollection
const userSessions = users.doc('player123').collection('sessions')
await userSessions.add({
  gameMode: 'ranked',
  score: 1500,
  date: new Date()
})
```

### Array Operations
\[\] Manipulate arrays atomically

```javascript
// Add to array
await users.doc('player123').update({
  achievements: arrayUnion('new-achievement')
})

// Remove from array
await users.doc('player123').update({
  achievements: arrayRemove('old-achievement')
})
```

### Increment Operations
ğŸ“ˆ Atomic numeric operations

```javascript
// Increment score atomically
await users.doc('player123').update({
  score: increment(100),
  gamesPlayed: increment(1)
})
```

---

<div style={{textAlign: 'center', padding: '2rem', backgroundColor: '#f0f9ff', border: '1px solid #bae6fd', borderRadius: '0.75rem', margin: '2rem 0'}}>
  <h2 style={{marginBottom: '1rem'}}>Continue Learning About GlobalDoc</h2>
  <p style={{marginBottom: '1.5rem'}}>Master advanced features and best practices</p>
  <div style={{display: 'flex', justifyContent: 'center', gap: '1rem'}}>
    <a href="/globalsync" style={{backgroundColor: '#0ea5e9', color: 'white', textDecoration: 'none', padding: '0.75rem 1.5rem', borderRadius: '0.5rem', fontWeight: 'bold'}}>Next: Real-time Features</a>
    <a href="/globalvault" style={{backgroundColor: 'white', color: '#0ea5e9', textDecoration: 'none', padding: '0.75rem 1.5rem', borderRadius: '0.5rem', border: '1px solid #0ea5e9', fontWeight: 'bold'}}>GlobalVault</a>
  </div>
</div>